# Manual Vulnerability Results Report Action

## Description

An action to create a CSV report for the following security testing tools based on provided CVE IDs or CWE IDs.

**Notes:**
- The action uses the NVD API to acquire additional information about CVE vulnerabilities for SCA reports.
  - NVD API is rate limited to 50 requests in a rolling 30 second window. The action caches CVE details to reduce the number of requests made.
- The action uses the OpenCVE API to acquire additional information about CWE vulnerabilities for SAST reports.
  - OpenCVE API is rate limited to 100 requests per minute. The action caches CWE details to reduce the number of requests made.

## Inputs

| name                                  | required | type   | default                             | description                                   |
|---------------------------------------|----------|--------|-------------------------------------|-----------------------------------------------|
| **nvd-api-key**                       | true     | string |                                     | API Key to access the NVD API                 |
| **opencve-username**                  | true     | string |                                     | Username to query OpenCVE API                 |
| **opencve-password**                  | true     | string |                                     | Password to query OpenCVE API                 |
| **security-tool-name**                | true     | string |                                     | Name of the security tool                     |
| **security-tool-csv-result-filename** | false    | string | manual-vulnerability-result.csv     | Name of the security tool CSV result filename |
| **cve-ids**                           | false    | string |                                     | Comma-separated list of CVE IDs               |
| **cwe-ids**                           | false    | string |                                     | Comma-separated list of CWE IDs               |
| **artifact-name**                     | false    | string | manual-vulnerability-results-report | Name of the artifact to upload                |
| **include-unit-tests**                | false    | string | false                               | Whether to run action unit tests              |

## Build Artifacts

The following build artifact is uploaded to the GitHub Actions workflow run. This can be changed using the `artifact-name` input.
- `manual-vulnerability-results-report`

## Example Execution

```yaml
- name: Create Manual Vulnerability Results Report
  uses: seansmith2600/H6060-Experiment-Resources/.github/actions/reporting/vulnerability-results-report/manual@main
  with:
    nvd-api-key: 11111111-2222-3333-4444-555555555555
    opencve-username: my-username
    opencve-password: my-password
    security-tool-name: sonarqube
    cwe-ids: CWE-79,CWE400
```

## Action Unit Tests

To run the action unit tests, set the `include-unit-tests` input to `true`.

## CSV Report

A report is generated in the root directory of the repository for each security testing tool and is uploaded as a build artifact.

The generated report contains the following columns.

### SCA Reports

| Name                   | Description                                            | Populated By Action |
|------------------------|--------------------------------------------------------|---------------------|
| Tool Type              | Type of security testing tool                          | false               |
| Tool Name              | Name of security testing tool                          | true                |
| Tool Version           | Version of security testing tool                       | false               |
| Tool Classification    | Classification of security testing tool                | false               |
| Language               | Programming language associated with vulnerability     | false               |
| Severity               | Severity of reported vulnerability                     | false               |
| Confidence             | Confidence of vulnerability accuracy                   | false               |
| Component Type         | Type of component associated with vulnerability        | false               |
| Component Name         | Name of component associated with vulnerability        | false               |
| Component Version      | Version of component associated with vulnerability     | false               |
| Component License      | License of component associated with vulnerability     | false               |
| Component Location     | Location of component associated with vulnerability    | false               |
| CVE ID                 | CWE ID                                                 | true                |
| CVE Description        | CVE description                                        | true                |
| CVE Source             | Organisation who reported CVE                          | true                |
| CVE Published Date     | Date CVE was published                                 | true                |
| CVE Last Modified Date | Date CVE was last modified                             | true                |
| CVE Status             | Current status of vulnerability                        | true                |
| CVE Malicious          | Whether CVE is malicious                               | false               |
| CVE Disputed           | Whether CVE is disputed                                | false               |
| CVSS V2 Vector         | CVSS V2 metrics                                        | true                |
| CVSS V3 Vector         | CVSS V3.1 or V3 metrics                                | true                |
| CVSS V4 Vector         | CVSS V2 metrics                                        | true                |
| CWE ID                 | CWE ID                                                 | true                |

### SAST Reports

| Name                | Description                                        | Populated By Action |
|---------------------|----------------------------------------------------|---------------------|
| Tool Type           | Type of security testing tool                      | false               |               
| Tool Name           | Name of security testing tool                      | true                |          
| Tool Version        | Version of security testing tool                   | false               |
| Tool Classification | Classification of security testing tool            | false               |
| Language            | Programming language associated with vulnerability | false               |
| Severity            | Severity of reported vulnerability                 | false               |
| Confidence          | Confidence of vulnerability accuracy               | false               |
| CWE ID              | CWE ID                                             | true                |
| CWE Name            | CWE Name                                           | true                |
| CWE Description     | CWE Description                                    | true                |
| CWE Impact          | Impact rating of CWE                               | false               |
| CWE Likelihood      | Likelihood of CWE exploitation                     | false               |
| OWASP Top 10        | Category of OWASP top 10 for CWE ID                | true                |
| MITRE Top 25        | Index of MITRE top 25 for CWE ID                   | true                |
| Rule ID             | Rule id associated with vulnerability              | false               |
| File                | File associated with vulnerability                 | false               |
| Line                | Line number associated with vulnerability          | false               |

## Resources

- [NVD API](https://csrc.nist.gov/Projects/Security-Content-Automation-Protocol/specifications/nvd)
- [OpenCVE API](https://opencve.io/docs)
- [Eclipse Steady](https://www.eclipse.org/steady/)
- [CodeQL](https://securitylab.github.com/tools/codeql)
- [DeepSource](https://deepsource.io/)
- [Dependabot](https://dependabot.com/)
- [SonarQube](https://www.sonarqube.org/)
